# PDFå¤„ç†å®Œæ•´æµç¨‹æ€»ç»“

## ğŸ¯ å½“å‰çŠ¶æ€ï¼šå®Œæ•´çš„ç«¯åˆ°ç«¯PDFå¤„ç†ç³»ç»Ÿ

ç»è¿‡ç³»ç»Ÿé›†æˆï¼Œ`pdf_parser_tool.py` ç°åœ¨åŒ…å«äº†ä»PDFæ–‡æ¡£åˆ°å®Œæ•´metadataçš„å…¨æµç¨‹å¤„ç†èƒ½åŠ›ã€‚

## ğŸ”„ å®Œæ•´å¤„ç†æµç¨‹ï¼ˆparse_page_splitæ¨¡å¼ï¼‰

### æ­¥éª¤1ï¼šPDFåˆ†å‰²å¤„ç†
- å°†PDFåˆ†å‰²ä¸ºå•é¡µæ–‡ä»¶
- é€é¡µè¿›è¡Œç²¾ç¡®çš„æ–‡æ¡£è§£æ
- é¿å…é¡µé¢æ ‡æ³¨æ¼‚ç§»é—®é¢˜

### æ­¥éª¤2ï¼šAIå¢å¼ºå¤„ç†
- æ–‡æœ¬æ¸…æ´—å’Œæ ‡å‡†åŒ–
- å›¾ç‰‡æè¿°ç”Ÿæˆ
- è¡¨æ ¼æè¿°ç”Ÿæˆ

### æ­¥éª¤3ï¼šå¤„ç†ç»“æœä¿å­˜
- ä¿å­˜å®Œæ•´çš„é¡µé¢æ•°æ®
- è¾“å‡ºï¼š`page_split_processing_result.json`

### æ­¥éª¤4ï¼šTOCæå–
- åŸºäºå®Œæ•´æ–‡æœ¬è¿›è¡ŒTOCåˆ†æ
- æ™ºèƒ½è¯†åˆ«æ–‡æ¡£ç»“æ„
- è¾“å‡ºï¼š`toc_extraction_result.json`

### æ­¥éª¤5ï¼šAIåˆ†å—
- åŸºäºTOCç»“æœè¿›è¡Œæ™ºèƒ½åˆ†å—
- ç”Ÿæˆè¯­ä¹‰å®Œæ•´çš„æ–‡æœ¬å—
- è¾“å‡ºï¼š`chunks_result.json`

### æ­¥éª¤6ï¼šMetadataå¤„ç† â­ **æ–°å¢å®Œæ•´é›†æˆ**
- **6.1 åŸºç¡€Metadataæå–**
  - ä»page_splitç»“æœæå–åŸºç¡€metadata
  - å¤„ç†TOC metadataå¹¶åˆå¹¶
  - æå–å›¾ç‰‡/è¡¨æ ¼metadataå¹¶åˆ†é…ç« èŠ‚ID
  - è¾“å‡ºï¼š`metadata/basic_metadata.json`

- **6.2 æ–‡æ¡£æ‘˜è¦ç”Ÿæˆ**
  - AIé©±åŠ¨çš„æ–‡æ¡£çº§æ‘˜è¦
  - æ–‡æ¡£ç±»å‹æ¨æ–­
  - ç»Ÿè®¡ä¿¡æ¯æ”¶é›†
  - è¾“å‡ºï¼š`metadata/document_summary.json`

- **6.3 ç« èŠ‚æ‘˜è¦ç”Ÿæˆ**
  - æ¯ä¸ªç« èŠ‚çš„è¯¦ç»†æ‘˜è¦
  - å¹¶è¡Œå¤„ç†æé«˜æ•ˆç‡
  - ç« èŠ‚åª’ä½“ç»Ÿè®¡
  - è¾“å‡ºï¼š`metadata/chapter_summaries.json`

- **6.4 è¡ç”Ÿé—®é¢˜ç”Ÿæˆ**
  - ä»æ–‡æœ¬å—ç”Ÿæˆå‡è®¾é—®é¢˜
  - æå‡RAGå¬å›ç‡
  - æ™ºèƒ½é—®é¢˜åˆ†ç±»
  - è¾“å‡ºï¼š`metadata/derived_questions.json`

## ğŸ“ å®Œæ•´è¾“å‡ºç»“æ„

```
parser_output/TIMESTAMP_page_split/
â”œâ”€â”€ page_1/                               # å•é¡µå¤„ç†ç»“æœ
â”‚   â”œâ”€â”€ picture-1.png
â”‚   â”œâ”€â”€ table-1.png
â”‚   â””â”€â”€ ...
â”œâ”€â”€ page_2/
â”œâ”€â”€ ...
â”œâ”€â”€ page_split_processing_result.json     # é¡µé¢åˆ†å‰²å¤„ç†ç»“æœ
â”œâ”€â”€ toc_extraction_result.json           # TOCæå–ç»“æœ
â”œâ”€â”€ chunks_result.json                   # AIåˆ†å—ç»“æœ
â””â”€â”€ metadata/                            # â­ å®Œæ•´metadataç›®å½•
    â”œâ”€â”€ basic_metadata.json              # åŸºç¡€å…ƒæ•°æ®
    â”œâ”€â”€ document_summary.json            # æ–‡æ¡£æ‘˜è¦
    â”œâ”€â”€ chapter_summaries.json           # ç« èŠ‚æ‘˜è¦
    â””â”€â”€ derived_questions.json           # è¡ç”Ÿé—®é¢˜
```

## ğŸ› ï¸ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1ï¼šé€šè¿‡PDFParserToolä½¿ç”¨å®Œæ•´æµç¨‹

```python
from src.pdf_processing.pdf_parser_tool import PDFParserTool

# åˆ›å»ºå·¥å…·å®ä¾‹
tool = PDFParserTool()

# è¿è¡Œå®Œæ•´æµç¨‹ï¼ˆåŒ…å«metadataå¤„ç†ï¼‰
result = tool.execute(
    action="parse_page_split",
    pdf_path="example.pdf",
    enable_ai_enhancement=True,
    docling_parallel_processing=False,  # Macä¸Šå»ºè®®ç¦ç”¨
    ai_parallel_processing=True
)

# è§£æç»“æœ
import json
result_data = json.loads(result)
output_dir = result_data["output_directory"]
```

### æ–¹æ³•2ï¼šä½¿ç”¨æµ‹è¯•è„šæœ¬éªŒè¯

```bash
python test_complete_pipeline.py
```

## ğŸ”§ è§£å†³çš„æ ¸å¿ƒé—®é¢˜

### 1. **å›¾ç‰‡/è¡¨æ ¼Metadataç¼ºå¤±é—®é¢˜** âœ… å·²è§£å†³
**é—®é¢˜**ï¼šå›¾ç‰‡å’Œè¡¨æ ¼metadataå­—æ®µç¼ºå¤±ï¼ŒåŒ…æ‹¬ï¼š
- chapter_id ç¼ºå¤±
- å­—æ®µåä¸åŒ¹é…ï¼ˆpath vs image_pathï¼‰
- metadataç»“æ„é”™è¯¯ï¼ˆwidthåœ¨metadata.widthè€Œä¸æ˜¯ç›´æ¥åœ¨widthï¼‰

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä¿®å¤äº†`metadata_extractor.py`ä¸­çš„å­—æ®µæå–é€»è¾‘
- å®ç°äº†åŸºäºfull_textçš„ç²¾ç¡®ç« èŠ‚åˆ†é…
- åœ¨`toc_extractor.py`ä¸­æ·»åŠ äº†å”¯ä¸€æ ‡è¯†ç¬¦

### 2. **æµç¨‹é›†æˆä¸å®Œæ•´é—®é¢˜** âœ… å·²è§£å†³
**é—®é¢˜**ï¼š`pdf_parser_tool.py`åªåŒ…å«åˆ°AIåˆ†å—çš„æ­¥éª¤ï¼Œç¼ºå°‘metadataå¤„ç†

**è§£å†³æ–¹æ¡ˆ**ï¼š
- åœ¨`_init_components`ä¸­é›†æˆäº†4ä¸ªmetadataç»„ä»¶
- åœ¨`_parse_page_split`ä¸­æ·»åŠ äº†å®Œæ•´çš„metadataå¤„ç†æµç¨‹
- ç¡®ä¿æ‰€æœ‰ç»„ä»¶ååŒå·¥ä½œ

### 3. **Chapter IDåˆ†é…ç²¾åº¦é—®é¢˜** âœ… å·²è§£å†³
**é—®é¢˜**ï¼šåŸæœ‰çš„é¡µé¢èŒƒå›´ä¼°ç®—æ–¹æ³•ä¸å¤Ÿç²¾ç¡®

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å®ç°äº†åŸºäºfull_textå†…å®¹çš„ç²¾ç¡®åŒ¹é…
- é€šè¿‡å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆå›¾ç‰‡IDã€è¡¨æ ¼IDï¼‰åå‘è¿½è¸ª
- ä½¿ç”¨æ™ºèƒ½çš„ç« èŠ‚æ˜ å°„ç®—æ³•

## ğŸ“Š ç³»ç»Ÿèƒ½åŠ›

### å½“å‰æ”¯æŒçš„å¤„ç†èƒ½åŠ›ï¼š
1. âœ… **PDFæ–‡æ¡£è§£æ** - å®Œæ•´çš„æ–‡æœ¬å’Œåª’ä½“æå–
2. âœ… **å›¾ç‰‡/è¡¨æ ¼å¤„ç†** - ç²¾ç¡®æå–å’Œä¸Šä¸‹æ–‡å…³è”
3. âœ… **AIå†…å®¹å¢å¼º** - æ–‡æœ¬æ¸…æ´—ã€åª’ä½“æè¿°
4. âœ… **æ–‡æ¡£ç»“æ„åˆ†æ** - TOCæå–å’Œæ™ºèƒ½åˆ†å—
5. âœ… **æ ‡å‡†åŒ–Metadata** - 6ç§å†…å®¹ç±»å‹çš„å®Œæ•´æ”¯æŒ
6. âœ… **AIæ‘˜è¦ç”Ÿæˆ** - æ–‡æ¡£çº§å’Œç« èŠ‚çº§æ‘˜è¦
7. âœ… **é—®é¢˜ç”Ÿæˆ** - RAGå¢å¼ºçš„è¡ç”Ÿé—®é¢˜
8. âœ… **å¹¶è¡Œå¤„ç†** - å¤šçº§å¹¶è¡Œä¼˜åŒ–
9. âœ… **é”™è¯¯å¤„ç†** - å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œé™çº§æœºåˆ¶

### æ€§èƒ½ç‰¹ç‚¹ï¼š
- **å¤„ç†é€Ÿåº¦**ï¼šå¹¶è¡Œå¤„ç†ä¼˜åŒ–ï¼Œå¤§å¹…æå‡æ•ˆç‡
- **ç²¾ç¡®åº¦**ï¼šè§£å†³é¡µé¢æ ‡æ³¨æ¼‚ç§»é—®é¢˜
- **å®Œæ•´æ€§**ï¼šç«¯åˆ°ç«¯çš„å®Œæ•´å¤„ç†æµç¨‹
- **å¯æ‰©å±•æ€§**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•
- **ç¨³å®šæ€§**ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶

## ğŸ‰ ç»“è®º

å½“å‰çš„`pdf_parser_tool.py`å·²ç»å®ç°äº†**å®Œæ•´çš„PDFåˆ°Metadataçš„ç«¯åˆ°ç«¯å¤„ç†ç³»ç»Ÿ**ï¼ŒåŒ…æ‹¬ï¼š

1. **å®Œæ•´çš„å¤„ç†æµç¨‹**ï¼šä»PDFæ–‡æ¡£åˆ°ç»“æ„åŒ–metadataçš„å…¨æµç¨‹
2. **ç²¾ç¡®çš„å†…å®¹å…³è”**ï¼šå›¾ç‰‡/è¡¨æ ¼ä¸ç« èŠ‚çš„ç²¾ç¡®æ˜ å°„
3. **AIé©±åŠ¨çš„å¢å¼º**ï¼šæ™ºèƒ½æ‘˜è¦å’Œé—®é¢˜ç”Ÿæˆ
4. **æ ‡å‡†åŒ–è¾“å‡º**ï¼šç»Ÿä¸€çš„metadata schema
5. **é«˜æ€§èƒ½å¤„ç†**ï¼šå¤šçº§å¹¶è¡Œä¼˜åŒ–

è¿™ä¸ªç³»ç»Ÿç°åœ¨å¯ä»¥ä½œä¸º**ç”Ÿäº§çº§çš„PDFçŸ¥è¯†æå–pipeline**ä½¿ç”¨ï¼Œä¸ºåç»­çš„RAGã€çŸ¥è¯†ç®¡ç†ã€æ–‡æ¡£åˆ†æç­‰åº”ç”¨æä¾›å®Œæ•´çš„æ•°æ®åŸºç¡€ã€‚ 