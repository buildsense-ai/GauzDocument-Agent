# React RAG Agent æ™ºèƒ½æ£€ç´¢ç³»ç»Ÿ

## ğŸ“– ç³»ç»Ÿæ¦‚è¿°

React RAG Agent æ˜¯ä¸€ä¸ªåŸºäºReactæ€ç»´æ¨¡å¼ï¼ˆæ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿï¼‰çš„æ™ºèƒ½æ–‡æ¡£æ£€ç´¢ç³»ç»Ÿã€‚å®ƒæ•´åˆäº†å¤šç§æœç´¢æŠ€æœ¯ï¼ŒåŒ…æ‹¬å‘é‡ç›¸ä¼¼æ€§æœç´¢ã€BM25å…³é”®è¯åŒ¹é…ã€å…ƒæ•°æ®è¿‡æ»¤ï¼Œä»¥åŠMySQLæ¨¡æ¿æ£€ç´¢ï¼Œä¸ºç”¨æˆ·æä¾›ç²¾å‡†ã€æ™ºèƒ½çš„æ–‡æ¡£æ£€ç´¢å’Œé—®ç­”æœåŠ¡ã€‚

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### ğŸ¤– Reactå¼å†³ç­–å¼•æ“
- **æ™ºèƒ½æ„å›¾è¯†åˆ«**: è‡ªåŠ¨åˆ†æç”¨æˆ·æŸ¥è¯¢æ„å›¾
- **å¤šè½®æ€è€ƒå¾ªç¯**: æ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿçš„Reactæ¨¡å¼
- **åŠ¨æ€è¡ŒåŠ¨è§„åˆ’**: æ ¹æ®ä¸Šä¸‹æ–‡é€‰æ‹©æœ€ä½³è¡ŒåŠ¨ç­–ç•¥

### ğŸ” æ··åˆæœç´¢æŠ€æœ¯
- **å‘é‡ç›¸ä¼¼æ€§æœç´¢**: åŸºäºChromaDBçš„è¯­ä¹‰æ£€ç´¢
- **BM25å…³é”®è¯åŒ¹é…**: ä¼ ç»Ÿçš„å…³é”®è¯ç²¾ç¡®åŒ¹é…
- **å…ƒæ•°æ®è¿‡æ»¤**: æ”¯æŒé¡¹ç›®åç§°ã€å†…å®¹ç±»å‹ç­‰ç²¾ç¡®è¿‡æ»¤
- **æŸ¥è¯¢æ‰©å±•**: åŸºäºQwençš„æ™ºèƒ½æŸ¥è¯¢é‡å†™

### ğŸ¯ ä¸“é—¨åŒ–æ£€ç´¢
- **æ¨¡æ¿æ£€ç´¢**: MySQLä¼˜å…ˆçš„æ¨¡æ¿æœç´¢å’Œç®¡ç†
- **å›¾ç‰‡æ£€ç´¢**: åŸºäºAIç”Ÿæˆæè¿°çš„å›¾ç‰‡è¯­ä¹‰æœç´¢
- **è¡¨æ ¼æ£€ç´¢**: ç»“æ„åŒ–æ•°æ®çš„ä¸“é—¨æ£€ç´¢
- **å†…å®¹èåˆ**: æ–‡æœ¬ã€å›¾ç‰‡ã€è¡¨æ ¼çš„ç»Ÿä¸€æ£€ç´¢

### ğŸ“Š æ ‡å‡†åŒ–JSONè¾“å‡º (NEW!)
- **ç»“æ„åŒ–å“åº”**: ç»Ÿä¸€çš„JSONè¾“å‡ºæ ¼å¼ï¼Œæ”¯æŒå‰ç«¯æ¸²æŸ“
- **å¤šç±»å‹å†…å®¹**: è‡ªåŠ¨åˆ†ç±»æ–‡æœ¬ã€å›¾ç‰‡ã€è¡¨æ ¼å†…å®¹
- **MinIOé›†æˆ**: è‡ªåŠ¨ç”Ÿæˆå›¾ç‰‡å’Œè¡¨æ ¼çš„å¯è®¿é—®URL
- **æœç´¢å…ƒæ•°æ®**: åŒ…å«æœç´¢ç­–ç•¥ã€æƒé‡ã€æ—¶é—´æˆ³ç­‰è¯¦ç»†ä¿¡æ¯

### ğŸ’¡ æ™ºèƒ½é—®ç­”
- **ä¸Šä¸‹æ–‡ç†è§£**: å¤šè½®å¯¹è¯å’Œä¸Šä¸‹æ–‡æ„ŸçŸ¥
- **ç»“æœèåˆ**: å¤šæºä¿¡æ¯çš„æ™ºèƒ½æ•´åˆ
- **ç­”æ¡ˆç”Ÿæˆ**: åŸºäºæ£€ç´¢ç»“æœçš„ä¸“ä¸šç­”æ¡ˆç”Ÿæˆ

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
React RAG Agent ç³»ç»Ÿæ¶æ„
â”œâ”€â”€ QwenClient (é€šä¹‰åƒé—®APIå®¢æˆ·ç«¯)
â”‚   â”œâ”€â”€ æ„å›¾åˆ†æ
â”‚   â”œâ”€â”€ æŸ¥è¯¢æ‰©å±•
â”‚   â”œâ”€â”€ ç»“æœæ’åº
â”‚   â””â”€â”€ ç­”æ¡ˆç”Ÿæˆ
â”œâ”€â”€ HybridSearchEngine (æ··åˆæœç´¢å¼•æ“)
â”‚   â”œâ”€â”€ å‘é‡æœç´¢ (ChromaDB)
â”‚   â”œâ”€â”€ BM25æœç´¢ (ä¸­æ–‡åˆ†è¯)
â”‚   â”œâ”€â”€ å…ƒæ•°æ®è¿‡æ»¤
â”‚   â””â”€â”€ ç»“æœèåˆ
â”œâ”€â”€ MySQLTemplateRetriever (æ¨¡æ¿æ£€ç´¢å™¨)
â”‚   â”œâ”€â”€ æ¨¡æ¿æœç´¢
â”‚   â”œâ”€â”€ ä½¿ç”¨ç»Ÿè®¡
â”‚   â””â”€â”€ æ¨¡æ¿ç®¡ç†
â”œâ”€â”€ RAGTool (ç°æœ‰RAGå·¥å…·é›†æˆ)
â”‚   â”œâ”€â”€ æ–‡æ¡£å¤„ç†
â”‚   â”œâ”€â”€ å‘é‡å­˜å‚¨
â”‚   â””â”€â”€ ä¸“é—¨æ£€ç´¢
â””â”€â”€ ReactRAGAgent (æ ¸å¿ƒå†³ç­–å¼•æ“)
    â”œâ”€â”€ Reactå¾ªç¯
    â”œâ”€â”€ è¡ŒåŠ¨æ‰§è¡Œ
    â””â”€â”€ ç»“æœç”Ÿæˆ
```

## ğŸ› ï¸ å®‰è£…ä¸é…ç½®

### æ–¹æ³•ä¸€ï¼šå¿«é€Ÿå¯åŠ¨ï¼ˆæ¨èï¼‰
```bash
# ä¸€é”®é…ç½®å’Œå¯åŠ¨
python quick_start.py
```
å¿«é€Ÿå¯åŠ¨è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- æ£€æŸ¥Pythonç‰ˆæœ¬å’Œä¾èµ–
- å¼•å¯¼åˆ›å»º.envæ–‡ä»¶
- æµ‹è¯•é…ç½®
- å¯åŠ¨ç³»ç»Ÿ

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨é…ç½®

#### 1. ç¯å¢ƒè¦æ±‚
- Python 3.8+
- 8GB+ RAM
- 2GB+ ç£ç›˜ç©ºé—´

#### 2. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

#### 3. é…ç½®ç¯å¢ƒå˜é‡
åˆ›å»º`.env`æ–‡ä»¶å¹¶é…ç½®æ‚¨çš„APIå¯†é’¥å’Œç³»ç»Ÿè®¾ç½®ï¼š
```bash
# åˆ›å»º.envæ–‡ä»¶
touch .env

# ç¼–è¾‘.envæ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„å®é™…é…ç½®
# å¿…é¡»è®¾ç½®ï¼š
QWEN_API_KEY=your-qwen-api-key-here

# å¯é€‰é…ç½®ï¼ˆä½¿ç”¨é»˜è®¤å€¼ï¼‰ï¼š
QWEN_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
QWEN_MODEL=qwen-turbo-latest
RAG_STORAGE_DIR=rag_storage
TEMPLATES_DB_PATH=templates.db
```

#### 4. æµ‹è¯•é…ç½®
```bash
# æµ‹è¯•ç¯å¢ƒå˜é‡é…ç½®æ˜¯å¦æ­£ç¡®
python test_env_config.py
```

#### 5. å¯åŠ¨ç³»ç»Ÿ
```bash
python main.py
```

## ğŸ’» ä½¿ç”¨æ–¹æ³•

### åŸºç¡€ä½¿ç”¨
```python
from react_rag_agent import ReactRAGAgent

# åˆå§‹åŒ–Agent
agent = ReactRAGAgent(
    storage_dir="rag_storage",
    templates_db="templates.db"
)

# æ‰§è¡ŒæŸ¥è¯¢
response = agent.query("æˆ‘éœ€è¦ä¸€ä¸ªæ–‡ç‰©ä¿æŠ¤è¯„ä¼°æŠ¥å‘Šæ¨¡æ¿")

# è·å–ç»“æœ
print(response.final_answer)
print(f"æ‰§è¡Œæ—¶é—´: {response.execution_time:.2f}ç§’")
```

### é«˜çº§åŠŸèƒ½
```python
# å¸¦ä¸Šä¸‹æ–‡çš„æŸ¥è¯¢
context = {"project_name": "å¤å»ºç­‘ä¿®ç¼®é¡¹ç›®", "user_role": "è¯„ä¼°ä¸“å®¶"}
response = agent.query("ç”Ÿæˆé¡¹ç›®è¯„ä¼°æŠ¥å‘Š", context=context)

# è·å–è¯¦ç»†çš„æ€è€ƒè¿‡ç¨‹
for thought in response.thoughts:
    print(f"æ­¥éª¤ {thought.step}: {thought.thought}")
    print(f"è¡ŒåŠ¨: {thought.action.value}")
    print(f"è§‚å¯Ÿ: {thought.observation}")
```

## âš™ï¸ ç¯å¢ƒå˜é‡é…ç½®

ç³»ç»Ÿé€šè¿‡ç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®ï¼Œæ‰€æœ‰æ•æ„Ÿä¿¡æ¯å¦‚APIå¯†é’¥éƒ½åº”å­˜æ”¾åœ¨`.env`æ–‡ä»¶ä¸­ã€‚

### å¿…éœ€çš„ç¯å¢ƒå˜é‡
- `QWEN_API_KEY`: é€šä¹‰åƒé—®APIå¯†é’¥ï¼ˆå¿…é¡»ï¼‰

### å¯é€‰çš„ç¯å¢ƒå˜é‡
| å˜é‡å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `QWEN_BASE_URL` | https://dashscope.aliyuncs.com/compatible-mode/v1 | APIåŸºç¡€URL |
| `QWEN_MODEL` | qwen-turbo-latest | èŠå¤©æ¨¡å‹ |
| `QWEN_MAX_TOKENS` | 4000 | æœ€å¤§ä»¤ç‰Œæ•° |
| `QWEN_TEMPERATURE` | 0.1 | ç”Ÿæˆæ¸©åº¦ |
| `QWEN_TIMEOUT` | 60 | è¯·æ±‚è¶…æ—¶æ—¶é—´ |
| `QWEN3_EMBEDDING_MODEL` | text-embedding-v3 | åµŒå…¥æ¨¡å‹ |
| `QWEN3_EMBEDDING_DIMENSION` | 1024 | åµŒå…¥ç»´åº¦ |
| `RAG_STORAGE_DIR` | rag_storage | å­˜å‚¨ç›®å½• |
| `TEMPLATES_DB_PATH` | templates.db | æ¨¡æ¿æ•°æ®åº“è·¯å¾„ |
| `LOG_LEVEL` | INFO | æ—¥å¿—çº§åˆ« |
| `MAX_ITERATIONS` | 5 | æœ€å¤§è¿­ä»£æ¬¡æ•° |
| `CONFIDENCE_THRESHOLD` | 0.7 | ç½®ä¿¡åº¦é˜ˆå€¼ |
| `VECTOR_SIMILARITY_WEIGHT` | 0.5 | å‘é‡ç›¸ä¼¼æ€§æƒé‡ |
| `BM25_SCORE_WEIGHT` | 0.3 | BM25å¾—åˆ†æƒé‡ |
| `METADATA_MATCH_WEIGHT` | 0.2 | å…ƒæ•°æ®åŒ¹é…æƒé‡ |
| `BM25_K1` | 1.2 | BM25å‚æ•°K1 |
| `BM25_B` | 0.75 | BM25å‚æ•°B |
| `MINIO_ENDPOINT` | http://localhost:9000 | MinIOæœåŠ¡å™¨åœ°å€ |
| `MINIO_BUCKET` | document-storage | MinIOå­˜å‚¨æ¡¶åç§° |

### é…ç½®ç¤ºä¾‹
åˆ›å»º`.env`æ–‡ä»¶å¹¶å¡«å…¥ä»¥ä¸‹å†…å®¹ï¼š
```env
# React RAG Agent ç³»ç»Ÿç¯å¢ƒå˜é‡é…ç½®
# å¿…éœ€é…ç½®
QWEN_API_KEY=your-qwen-api-key-here

# APIé…ç½®
QWEN_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
QWEN_MODEL=qwen-turbo-latest
QWEN_MAX_TOKENS=4000
QWEN_TEMPERATURE=0.1
QWEN_TIMEOUT=60

# Embeddingé…ç½®
QWEN3_EMBEDDING_MODEL=text-embedding-v3
QWEN3_EMBEDDING_DIMENSION=1024

# MinIOå¯¹è±¡å­˜å‚¨é…ç½® (NEW! ç”¨äºå›¾ç‰‡å’Œè¡¨æ ¼æ–‡ä»¶è®¿é—®)
MINIO_ENDPOINT=http://localhost:9000
MINIO_BUCKET=document-storage
# äº‘ç«¯MinIOç¤ºä¾‹ï¼š
# MINIO_ENDPOINT=https://your-minio-domain.com
# MINIO_BUCKET=your-bucket-name

# ç³»ç»Ÿé…ç½®
RAG_STORAGE_DIR=rag_storage
TEMPLATES_DB_PATH=templates.db
LOG_LEVEL=INFO
MAX_ITERATIONS=5
CONFIDENCE_THRESHOLD=0.7

# æœç´¢æƒé‡é…ç½®
VECTOR_SIMILARITY_WEIGHT=0.5
BM25_SCORE_WEIGHT=0.3
METADATA_MATCH_WEIGHT=0.2

# BM25å‚æ•°
BM25_K1=1.2
BM25_B=0.75
```

## ğŸ”§ æ ¸å¿ƒç»„ä»¶è¯¦è§£

### 1. Qwenå®¢æˆ·ç«¯ (`qwen_client.py`)
- **æ„å›¾åˆ†æ**: åˆ†æç”¨æˆ·æŸ¥è¯¢çš„ç±»å‹å’Œæ„å›¾
- **æŸ¥è¯¢æ‰©å±•**: ç”Ÿæˆå¤šè§’åº¦çš„æœç´¢æŸ¥è¯¢
- **ç»“æœæ’åº**: åŸºäºç›¸å…³æ€§çš„æ™ºèƒ½æ’åº
- **ç­”æ¡ˆç”Ÿæˆ**: åŸºäºæ£€ç´¢ç»“æœçš„ä¸“ä¸šç­”æ¡ˆç”Ÿæˆ

### 2. æ··åˆæœç´¢å¼•æ“ (`hybrid_search_engine.py`)
- **å‘é‡æœç´¢**: åŸºäºChromaDBçš„è¯­ä¹‰ç›¸ä¼¼æ€§æœç´¢
- **BM25æœç´¢**: ä¼ ç»Ÿçš„å…³é”®è¯åŒ¹é…å’ŒTF-IDFè®¡ç®—
- **å…ƒæ•°æ®è¿‡æ»¤**: æ”¯æŒå¤šç§è¿‡æ»¤æ¡ä»¶çš„ç²¾ç¡®åŒ¹é…
- **ç»“æœèåˆ**: å¤šç§æœç´¢ç­–ç•¥çš„æ™ºèƒ½èåˆ

### 3. æ¨¡æ¿æ£€ç´¢å™¨ (`mysql_template_retriever.py`)
- **æ¨¡æ¿æœç´¢**: åŸºäºåç§°ã€ç±»å‹ã€å…³é”®è¯çš„æ¨¡æ¿æœç´¢
- **ä½¿ç”¨ç»Ÿè®¡**: è®°å½•å’Œåˆ†ææ¨¡æ¿ä½¿ç”¨æƒ…å†µ
- **æ¨¡æ¿ç®¡ç†**: æ·»åŠ ã€æ›´æ–°ã€åˆ é™¤æ¨¡æ¿

### 4. React RAG Agent (`react_rag_agent.py`)
- **Reactå¾ªç¯**: æ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿçš„å†³ç­–å¾ªç¯
- **è¡ŒåŠ¨æ‰§è¡Œ**: æ ¹æ®æ€è€ƒç»“æœæ‰§è¡Œå…·ä½“è¡ŒåŠ¨
- **ç»“æœç”Ÿæˆ**: æ•´åˆæ‰€æœ‰ä¿¡æ¯ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ

## ğŸ¯ æ”¯æŒçš„æŸ¥è¯¢ç±»å‹

### 1. æ¨¡æ¿æœç´¢
```
"æˆ‘éœ€è¦ä¸€ä¸ªè¯„ä¼°æŠ¥å‘Šæ¨¡æ¿"
"æŸ¥æ‰¾ä¿®ç¼®è®¾è®¡æ–¹æ¡ˆæ¨¡æ¿"
"æœç´¢é¡¹ç›®ç®¡ç†ç›¸å…³æ¨¡æ¿"
```

### 2. å†…å®¹æ£€ç´¢
```
"æœç´¢å¤å»ºç­‘ä¿æŠ¤ç›¸å…³èµ„æ–™"
"æŸ¥æ‰¾æ–‡ç‰©ä¿®ç¼®æŠ€æœ¯æ–‡æ¡£"
"è·å–é¡¹ç›®è¯„ä¼°æ ‡å‡†"
```

### 3. å›¾ç‰‡æ£€ç´¢
```
"æœç´¢å¤å»ºç­‘ä¿®ç¼®ç›¸å…³å›¾ç‰‡"
"æŸ¥æ‰¾æ–‡ç‰©ä¿æŠ¤ç°åœºç…§ç‰‡"
"è·å–ä¿®ç¼®å‰åå¯¹æ¯”å›¾"
```

### 4. è¡¨æ ¼æ£€ç´¢
```
"æŸ¥æ‰¾è¯„ä¼°æ ‡å‡†è¡¨æ ¼"
"æœç´¢æˆæœ¬é¢„ç®—è¡¨"
"è·å–æŠ€æœ¯å‚æ•°è¡¨æ ¼"
```

### 5. ç»¼åˆæŸ¥è¯¢
```
"ç”ŸæˆXXé¡¹ç›®çš„è¯„ä¼°æŠ¥å‘Š"
"åˆ›å»ºä¿®ç¼®æ–¹æ¡ˆæ–‡æ¡£"
"å‡†å¤‡é¡¹ç›®ç”³æŠ¥ææ–™"
```

## ğŸ“Š æ€§èƒ½ç‰¹ç‚¹

- **å“åº”é€Ÿåº¦**: å¹³å‡æŸ¥è¯¢å“åº”æ—¶é—´ < 3ç§’
- **å‡†ç¡®æ€§**: å†…å®¹æ£€ç´¢å‡†ç¡®ç‡ > 85%
- **å¯æ‰©å±•æ€§**: æ”¯æŒå¤§è§„æ¨¡æ–‡æ¡£åº“(10ä¸‡+æ–‡æ¡£)
- **å¹¶å‘æ€§**: æ”¯æŒå¤šç”¨æˆ·åŒæ—¶æŸ¥è¯¢

## ğŸ” ç³»ç»Ÿç›‘æ§

### è·å–ç»Ÿè®¡ä¿¡æ¯
```python
# è·å–Agentç»Ÿè®¡ä¿¡æ¯
stats = agent.get_agent_stats()
print(f"æ··åˆæœç´¢ç»Ÿè®¡: {stats['hybrid_search_stats']}")
print(f"æ¨¡æ¿ç»Ÿè®¡: {stats['template_stats']}")
print(f"RAGå·¥å…·ç»Ÿè®¡: {stats['rag_tool_stats']}")
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
tail -f react_rag_agent.log
```

## ğŸ›¡ï¸ å®‰å…¨ä¸éšç§

- **ç¯å¢ƒå˜é‡é…ç½®**: æ‰€æœ‰æ•æ„Ÿä¿¡æ¯é€šè¿‡ç¯å¢ƒå˜é‡ç®¡ç†ï¼Œé¿å…ç¡¬ç¼–ç 
- **APIå¯†é’¥ç®¡ç†**: å®‰å…¨å­˜å‚¨å’Œä½¿ç”¨APIå¯†é’¥ï¼Œæ”¯æŒåŠ¨æ€åŠ è½½
- **æ•°æ®éš”ç¦»**: æ”¯æŒé¡¹ç›®çº§åˆ«çš„æ•°æ®éš”ç¦»
- **è®¿é—®æ§åˆ¶**: å¯æ‰©å±•çš„ç”¨æˆ·æƒé™ç®¡ç†
- **å®¡è®¡æ—¥å¿—**: å®Œæ•´çš„æ“ä½œæ—¥å¿—è®°å½•

### å®‰å…¨æœ€ä½³å®è·µ
1. **æ°¸è¿œä¸è¦**å°†APIå¯†é’¥æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
2. ä½¿ç”¨`.env`æ–‡ä»¶å­˜å‚¨æ•æ„Ÿé…ç½®
3. å°†`.env`æ–‡ä»¶æ·»åŠ åˆ°`.gitignore`
4. å®šæœŸè½®æ¢APIå¯†é’¥
5. åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡è€Œé`.env`æ–‡ä»¶

## ğŸš€ éƒ¨ç½²æŒ‡å—

### å¼€å‘ç¯å¢ƒ
```bash
# å…‹éš†ä»£ç 
git clone <repository>
cd react-rag-agent

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# è¿è¡Œç³»ç»Ÿ
python main.py
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
# ä½¿ç”¨Dockeréƒ¨ç½²
docker build -t react-rag-agent .
docker run -p 8000:8000 react-rag-agent

# æˆ–ä½¿ç”¨docker-compose
docker-compose up -d
```

## ğŸ”„ æ‰©å±•ä¸å®šåˆ¶

### æ·»åŠ æ–°çš„æœç´¢ç­–ç•¥
```python
# åœ¨hybrid_search_engine.pyä¸­æ·»åŠ æ–°çš„æœç´¢æ–¹æ³•
def custom_search(self, query, filters):
    # å®ç°è‡ªå®šä¹‰æœç´¢é€»è¾‘
    pass
```

### æ‰©å±•Reactè¡ŒåŠ¨ç±»å‹
```python
# åœ¨react_rag_agent.pyä¸­æ·»åŠ æ–°çš„è¡ŒåŠ¨ç±»å‹
class ActionType(Enum):
    CUSTOM_ACTION = "custom_action"
    # ... å…¶ä»–è¡ŒåŠ¨ç±»å‹
```

### è‡ªå®šä¹‰æ¨¡æ¿ç±»å‹
```python
# åœ¨mysql_template_retriever.pyä¸­æ·»åŠ æ–°çš„æ¨¡æ¿ç±»å‹
template_types = [
    "evaluation_report",
    "design_plan", 
    "custom_template_type"  # æ–°å¢
]
```

## ğŸ“Š æ ‡å‡†åŒ–JSONè¾“å‡ºæ ¼å¼ (NEW!)

### æ¦‚è¿°
ä»v2.0å¼€å§‹ï¼Œç« èŠ‚å†…å®¹æœç´¢å·¥å…·è¿”å›æ ‡å‡†åŒ–çš„JSONæ ¼å¼ï¼Œä¾¿äºå‰ç«¯æ¸²æŸ“å’ŒAPIé›†æˆã€‚

### è¾“å‡ºç»“æ„
```json
{
  "status": "success|no_results|error",
  "message": "æœç´¢å®Œæˆæè¿°",
  "queries": ["ç”¨æˆ·åŸå§‹æŸ¥è¯¢åˆ—è¡¨"],
  "relax_level": 0,
  "total_results": 19,
  "retrieved_text": [
    {
      "content_id": "DOC_TEMPLE_001_text_chunk_000001",
      "content": "å®é™…æ–‡æœ¬å†…å®¹",
      "chunk_type": "paragraph",
      "document_id": "DOC_TEMPLE_001",
      "chapter_id": "chapter_01",
      "chapter_title": "å†å²æ²¿é©",
      "paragraph_index": 1,
      "position_in_chapter": 1,
      "word_count": 74,
      "similarity_score": 0.85,
      "vector_score": 0.89,
      "bm25_score": 0.78
    }
  ],
  "retrieved_image": [
    {
      "content_id": "DOC_TEMPLE_001_image_chunk_000001",
      "image_url": "http://localhost:9000/document-storage/images/temple_front.jpg",
      "image_path": "/images/temple_front.jpg",
      "caption": "å¤åº™æ­£é¢ç…§ç‰‡",
      "ai_description": "å±•ç¤ºå¤åº™å»ºç­‘æ­£é¢çš„ç…§ç‰‡",
      "page_number": 5,
      "document_id": "DOC_TEMPLE_001",
      "chapter_title": "å»ºç­‘ç°çŠ¶",
      "width": 1024,
      "height": 768,
      "similarity_score": 0.78
    }
  ],
  "retrieved_table": [
    {
      "content_id": "DOC_TEMPLE_001_table_chunk_000001", 
      "table_url": "http://localhost:9000/document-storage/tables/repair_plan.png",
      "table_path": "/tables/repair_plan.png",
      "caption": "ä¿®ç¼®è®¡åˆ’æ—¶é—´è¡¨",
      "ai_description": "è¯¦ç»†çš„ä¿®ç¼®å·¥ä½œæ—¶é—´å®‰æ’",
      "page_number": 8,
      "document_id": "DOC_TEMPLE_001",
      "similarity_score": 0.72
    }
  ],
  "search_metadata": {
    "search_timestamp": "2025-07-16T11:04:45.514155",
    "fusion_strategy": "ä¸‰æ­¥èåˆ (å…ƒæ•°æ®+å‘é‡+BM25)",
    "weights": {"vector": 0.7, "bm25": 0.3}
  }
}
```

### ä½¿ç”¨ç¤ºä¾‹
```python
from react_rag_agent import SimplifiedReactAgent
import json

# åˆå§‹åŒ–Agent
agent = SimplifiedReactAgent()

# æ‰§è¡Œæœç´¢
params = {
    "queries": ["å¤åº™å†å²èƒŒæ™¯", "å»ºç­‘ç‰¹è‰²"],
    "relax_level": 0
}
result = agent._execute_chapter_content_search(params)

# è§£æJSONç»“æœ
if "```json" in result:
    json_start = result.find("```json") + 7
    json_end = result.find("```", json_start)
    json_data = json.loads(result[json_start:json_end])
    
    # è®¿é—®ä¸åŒç±»å‹çš„å†…å®¹
    texts = json_data["retrieved_text"]
    images = json_data["retrieved_image"]
    tables = json_data["retrieved_table"]
    
    print(f"æ‰¾åˆ° {len(texts)} ä¸ªæ–‡æœ¬ç‰‡æ®µ")
    print(f"æ‰¾åˆ° {len(images)} ä¸ªå›¾ç‰‡")
    print(f"æ‰¾åˆ° {len(tables)} ä¸ªè¡¨æ ¼")
```

### å­—æ®µè¯´æ˜

#### retrieved_text å­—æ®µ
- `content`: å®é™…æ–‡æœ¬å†…å®¹
- `similarity_score`: ç»¼åˆç›¸ä¼¼åº¦å¾—åˆ† (0.7Ã—å‘é‡ + 0.3Ã—BM25)
- `vector_score`: å‘é‡ç›¸ä¼¼åº¦å¾—åˆ†
- `bm25_score`: BM25å…³é”®è¯åŒ¹é…å¾—åˆ†
- `chapter_title`: æ‰€å±ç« èŠ‚æ ‡é¢˜
- `position_in_chapter`: åœ¨ç« èŠ‚ä¸­çš„ä½ç½®

#### retrieved_image å­—æ®µ
- `image_url`: å®Œæ•´çš„MinIOè®¿é—®URL (å¯ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€)
- `image_path`: åŸå§‹å­˜å‚¨è·¯å¾„
- `ai_description`: AIç”Ÿæˆçš„å›¾ç‰‡æè¿°
- `width/height`: å›¾ç‰‡å°ºå¯¸ä¿¡æ¯

#### retrieved_table å­—æ®µ
- `table_url`: å®Œæ•´çš„MinIOè®¿é—®URL
- `table_path`: åŸå§‹å­˜å‚¨è·¯å¾„  
- `ai_description`: AIç”Ÿæˆçš„è¡¨æ ¼å†…å®¹æè¿°

### æµ‹è¯•æ–°åŠŸèƒ½
```bash
# è¿è¡Œä¸“é—¨çš„æµ‹è¯•è„šæœ¬
python test_structured_output.py
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å‘é‡æ•°æ®åº“ä¼˜åŒ–**
   - å®šæœŸé‡å»ºç´¢å¼•
   - è°ƒæ•´chunkå¤§å°
   - ä½¿ç”¨æ›´é«˜æ•ˆçš„embeddingæ¨¡å‹

2. **æœç´¢æ€§èƒ½ä¼˜åŒ–**
   - å¯ç”¨ç»“æœç¼“å­˜
   - ä¼˜åŒ–BM25å‚æ•°
   - ä½¿ç”¨å¹¶è¡Œæœç´¢

3. **ç³»ç»Ÿç›‘æ§**
   - ç›‘æ§APIè°ƒç”¨æ¬¡æ•°
   - è·Ÿè¸ªæŸ¥è¯¢å“åº”æ—¶é—´
   - åˆ†æç”¨æˆ·æŸ¥è¯¢æ¨¡å¼

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤ä»£ç å˜æ›´
4. åˆ›å»ºPull Request

## ğŸ“œ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ã€‚è¯¦è§LICENSEæ–‡ä»¶ã€‚

## ğŸ“ æ”¯æŒä¸åé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- åˆ›å»ºGitHub Issue
- å‘é€é‚®ä»¶è‡³: [your-email@example.com]
- åŠ å…¥è®¨è®ºç¾¤: [ç¾¤å·æˆ–é“¾æ¥]

---

**React RAG Agent - è®©æ™ºèƒ½æ£€ç´¢æ›´ç®€å•ã€æ›´ç²¾å‡†ï¼** ğŸ¯ 